\section{Exploratory data analysis}

\subsection{Principal component analysis }

To further explore patterns in the data, a Principal Component Analysis (PCA) was performed by singular value decomposition on the meteorite data.
Because PCA is very sensitive to outliers some procedures had to be performed on the data in advance of the svd. First,
the data was centered by pertubing with the geomtric mean. Next, the data was scaled by the inverse square 
root of the total variance, normalizing its overall dispersion to prevent domination by highly variable components Finally, 
the data was CLR-transformed; this step ensures that the Euclidean distance metric implied in the SVD is valid for our data.  

The PCA has been visualised using a biplot and screeplot in Fig. \ref{fig:pcabiplot}. The biplot shows the first two principal components of the data with the samples
represented as points/samples and the variables/parts as arrows. The length of the arrow indicates the importance of the variable in the PCA, and the angle between the arrows indicates how correlated they are.
The screeplot shows the proportion of variance explained by each principal component, which is useful for determining how many components to retain in the analysis. 

In this case, the scree plot shows that with only two components, we can explain 96\% of the variance in the dataset, indicating that this decomposition is highly useful for further analysis.

At first glance of the biplot we see that all the loadings of the metal oxides tend point in the same direction, this means that they are all positively correlated, while the pure metals \{Ni, Co, Fe\} is opositely correlated as the loadings of these metals points in the oposite direction of loadings of the metal oxides. This means that when we see a lot of metaloxides in a meteorite we will not see a lot of the pure metals and vice verse. The loading of Carbon on the other hand is somewhat 
perpedicular to the rest of the loadings, which suggests that there is neither a strong nor negative correlation between the 
C and the rest of the metals. 


\input{figures/pca_biplot.tex} %

\subsection{Subcompositional analysis }

From the Fig. \ref{fig:pcabiplot}, we can identify a few subcompostions where two parts loadings vertices 
are allined, the most profound of these being the Carbon loading bein perpandicular to the loadings of MgO and $SiO_2$. This subcomposition can be analysised in a ternary diagram as seen on Fig \ref{fig:ternary}. In this plot, we have first taken out the subcomposition MgO, $SiO_2$, C, applied closure to 100, center the data by pertunbation with the geometrical mean, and then finally we do a svd on this to get the eigenvalues and principal components. Additionally the explained variance of the two components was calculated by $\lambda_{i}^{2} / \sum^{i} \lambda_{i}^{2}$. PC1 describes the variation overwhelmingly well with 94.9\% of the variation in the dataset. On the ternary plot the points represents the samples from these three parts, and the line is plotted by $y = (\alpha \otimes eigenvector_{\mathrm{PC1}}) \oplus g_m$. We see high variance explained by the first PC1 in the dact that the samples are distributed very close to the line, and with a very short distance to the line indicating the very small 5.1\% captures by the PC2. 

\begin{table}[h!]
\centering
\begin{tabular}{lrrrrr}
\hline
      & MgO      & SiO$_2$   & C         & $\lambda$   & Explained Var \\
\hline
PC1   & 1.164    & 1.251     & -2.415    & 2.959       & 94.9\% \\
PC2   & 0.113    & -0.110    & -0.003    & 0.157       & 5.1\% \\
\hline
\end{tabular}
\caption{PCA Loadings and Explained Variance for MgO, SiO$_2$, and C}
\label{tab:pca_loadings}
\end{table}

\paragraph{Balance for PC2}  
The second principal component (PC2) represents the log-ratio balance between MgO and the combined contributions of SiO$_2$ and C:
\[
\mathrm{PC2} = \log\left( \frac{\mathrm{MgO}^{0.113}}{\mathrm{SiO_2}^{0.110} \, C^{0.003}} \right)
\]
This balance remains nearly constant across the dataset, reflecting that variations in MgO are proportionally matched by variations in SiO$_2$ and C, leaving only approximately 5\% of the total variance to be explained by PC2. 


\input{figures/ternary_plot.tex}


\subsection{Clusering using self organising maps}


\input{handin/figures/som_with_data_points}


\input{}

\input{handin/figures/locations_clusters_convexhull}

